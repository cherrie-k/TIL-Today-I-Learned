# 7.3 ë¼ì´í”„ì‚¬ì´í´ ë©”ì„œë“œ ì‚¬ìš©í•˜ê¸°

7.2ì—ì„œ ì‚´í´ë³¸ ë¼ì´ë¸Œì‚¬ì´í´ ë©”ì†Œë“œë¥¼ ì§ì ‘ ì‚¬ìš©í•´ë³´ì ~~

ê° ë¼ì´í”„ì‚¬ì´í´ ë©”ì†Œë“œë¥¼ ì‹¤í–‰í•  ë•Œë§ˆë‹¤ ì½˜ì†” ë””ë²„ê±°ì— ê¸°ë¡í•˜ê³ , 
ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸ì—ì„œ propsë¡œ ìƒ‰ìƒì„ ë°›ì•„ ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ state.number ê°’ì„ 1ì”© ë”í•˜ëŠ” ì»´í¬ë„ŒíŠ¸ë¥¼ ë§Œë“¤ì–´ë³´ì~!

```jsx
// LifeCycleSample.js
// ê° ë¼ì´í”„ì‚¬ì´í´ ë©”ì†Œë“œë¥¼ ì‹¤í–‰í•  ë•Œë§ˆë‹¤ ì½˜ì†” ë””ë²„ê±°ì— ê¸°ë¡í•˜ê³ , 
// ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸ì—ì„œ propsë¡œ ìƒ‰ìƒì„ ë°›ì•„ ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ state.number ê°’ì„ 1ì”© ë”í•˜ëŠ” ì»´í¬ë„ŒíŠ¸

import { Component } from 'react';

class LifeCycleSample extends Component {
  state = {
    number: 0,
    color: null,
  };

  myRef = null; // refë¥¼ ì„¤ì •í•  ë¶€ë¶„

  constructor(props) {
    super(props);
    console.log('constructor');
  }

  // ë¶€ëª¨ì—ê²Œì„œ ë°›ì€ color ê°’ì„ stateì— ë™ê¸°í™”
  static getDerivedStateFromProps(nextProps, prevState) {
    console.log('getDerivedStateFromProps');
    if (nextProps.color !== prevState.color) {
      // ì¡°ê±´ì— ë”°ë¼ íŠ¹ì • ê°’ stateì— ë™ê¸°í™”
      return { color: nextProps.color };
    }
    return null; // state ë³€ê²½ í•  í•„ìš” ì—†ë‹¤ë©´ null ë°˜í™˜
  }

  componentDidMount() {
    console.log('componentDidMount');
  }

  shouldComponentUpdate(nextProps, nextState) {
    console.log(
      'shouldComponentUpdate',
      'nextProps: ',
      nextProps,
      'nextState: ',
      nextState
    );
    // ìˆ«ìì˜ ë§ˆì§€ë§‰ ìë¦¬ê°€ 4(ì˜ˆ: 4, 24 ë“±)ë©´ ë¦¬ë Œë”ë§í•˜ì§€ ì•ŠìŒ
    return nextState.number % 10 !== 4;
  }

  componentWillUnmount() {
    console.timeLog('componentWillUnmount');
  }

  handleClick = () => {
    this.setState({
      number: this.state.number + 1,
    });
  };

  // DOMì— ë³€í™”ê°€ ì¼ì–´ë‚˜ê¸° ì§ì „ì˜ ìƒ‰ìƒ ì†ì„±ì„ snapshot ê°’ìœ¼ë¡œ ë°˜í™˜ -> componentDidUpdateì—ì„œ ì¡°íšŒ ê°€ëŠ¥
  getSnapshotBeforeUpdate(prevProps, prevState) {
    console.log('getSnapshoBeforeUpdate');
    if (prevProps.color !== this.props.color) {
      return this.myRef.style.color;
    }
    return null;
  }

  // getSnapshotBeforeUpdateì—ì„œ ë°˜í™˜í•œ snapshotì„ ì‚¬ìš©
  componentDidUpdate(prevProps, prevState, snapshot) {
    console.log(
      'componentDidUpdate',
      'prevProps: ',
      prevProps,
      'prevState: ',
      prevState
    );
    if (snapshot) {
      console.log('ì—…ë°ì´íŠ¸ë˜ê¸° ì§ì „ ìƒ‰ìƒ: ', snapshot);
    }
  }

  render() {
    console.log('render');

    const stylee = {
      color: this.props.color,
    };

    return (
      <div>
        <h1 style={stylee} ref={(ref) => (this.myRef = ref)}>
          {this.state.number}
        </h1>
        <p>color: {this.state.color}</p>
        <button onClick={this.handleClick}>ë”í•˜ê¸°</button>
      </div>
    );
  }
}

export default LifeCycleSample;
```

```jsx
// LifeCycleSampleParent.js
import { Component } from 'react';
import LifeCycleSample from './LifeCycleSample';

// ëœë¤ ìƒ‰ìƒ ìƒì„±
function getRandomColor() {
  // 000000ë¶€í„° ffffff ê°’ì„ ë°˜í™˜
  return (
    '#' +
    Math.floor(
      Math.random() * 16777215 /*16777215ë¥¼ hexë¡œ í‘œí˜„í•˜ë©´ ffffff*/
    ).toString(16)
  );
}

class LifeCycleSampleParent extends Component {
  state = {
    color: '#000000',
  };

  handleClick = () => {
    // ëœë¤ ìƒ‰ìƒ ë²„íŠ¼ ëˆ„ë¥¼ë•Œë§ˆë‹¤ í˜¸ì¶œë˜ì–´ ëœë¤ìƒ‰ìƒì´ë²¤íŠ¸ ì„¤ì •.
    // ë¶ˆëŸ¬ì˜¨ LifeCycleSample ì»´í¬ë„ŒíŠ¸ì— color ê°’ì„ propsë¡œ ì„¤ì •í•¨.
    this.setState({
      color: getRandomColor(),
    });
  };

  render() {
    return (
      <div>
        <div>
          ìœ„ì•„ë˜ ë²„íŠ¼ì„ ë²ˆê°ˆì•„ ëˆ„ë¥´ë©´ì„œ ì–´ë–¤ ë¼ì´í”„ì‚¬ì´í´ ë©”ì†Œë“œë“¤ì„ ì‹¤í–‰í•˜ëŠ”ì§€
          ì²´í¬í•´ë³´ì! (React.strictMode) ì ì‹œ í•´ì œ
        </div>
        <div>ë§ˆì§€ë§‰ ìˆ˜ê°€ 4ì¼ ë•Œ ì—…ë°ì´íŠ¸ ì·¨ì†Œí•˜ëŠ”ì§€ë„ í™•ì¸í•´ë³´ì!</div>
        <button onClick={this.handleClick}> ëœë¤ ìƒ‰ìƒ </button>
        <LifeCycleSample color={this.state.color} />
      </div>
    );
  }
}

export default LifeCycleSampleParent;
```

ì£¼ì„ ì„¤ëª… ì˜ ì½ì–´ë³´ê¸°!

### ì—ëŸ¬ ì¡ì•„ë‚´ê¸°

ì»´í¬ë„ŒíŠ¸ì˜ render í•¨ìˆ˜ì—ì„œ ì˜ë„ì ìœ¼ë¡œ ì—ëŸ¬ ë°œìƒì‹œí‚¨ í›„ ì´ë¥¼ ì¡ì•„ë³´ê² ìŒ

<aside>
ğŸ’¡ render í•¨ìˆ˜ì—ì„œì˜ ì—ëŸ¬ëŠ” ì£¼ë¡œ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ë ¤ê³  í•˜ê±°ë‚˜, ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ê°ì²´ì˜ ê°’ì„ ì¡°íšŒí•˜ë ¤ í•  ë•Œ ë°œìƒ.

</aside>

LifeCycleSample ì»´í¬ë„ŒíŠ¸ ë‚´ì˜ render í•¨ìˆ˜ë¥¼ ë‹¤ìŒê³¼ ê°™ì´ ìˆ˜ì •í•´ë³´ì

```jsx
render() {
    console.log('render');

    const stylee = {
      // parentì—ì„œ ëœë¤ìœ¼ë¡œ ìƒì„±í•œ ìƒ‰ì„ colorì— ì ìš©ì‹œì¼œì¤Œ
      color: this.props.color,
    };

    return (
      <div>
        {this.props.missing.value /* ì˜ë„ì ìœ¼ë¡œ ì—ëŸ¬ ë°œìƒì‹œí‚´ */}
        <h1 style={stylee} ref={(ref) => (this.myRef = ref)}>
          {this.state.number}
        </h1>
        {/*parentì—ì„œ ëœë¤ìœ¼ë¡œ ìƒì„±í•œ ìƒ‰ì„ textë¡œ ë„ì›Œì¤Œ*/}
        <p>color: {this.state.color}</p>
        <button onClick={this.handleClick}>ë”í•˜ê¸°</button>
      </div>
    );
  }
```

ê²°ê³¼: ë Œë” ì‹¤íŒ¨í•˜ê³ 

Uncaught TypeError: Cannot read properties of undefined (reading 'value')

ê°€ ë°œìƒí•œë‹¤!

ì € ì—ëŸ¬ ë©”ì‹œì§€ëŠ” ìš°ë¦¬ê°€ ê°œë°œ ì„œë²„ë¥¼ ì‹¤í–‰ì¤‘ì´ê¸° ë•Œë¬¸ì— ë‚˜íƒ€ë‚˜ëŠ”ê±°ê³ , ê°œë°œì ë„êµ¬ë¥¼ ë‹«ìœ¼ë©´ ì‚¬ìš©ìëŠ” ê·¸ëƒ¥ ë Œë”ì— ì‹¤íŒ¨í•œ ë¹ˆ í™”ë©´ë§Œ ë³´ê²Œ ë˜ê¸° ë•Œë¬¸ì— ë­ê°€ ë¬¸ì œì¸ì§€ ëª¨ë¦„.

ë”°ë¼ì„œ ì´ëŸ´ ë• ì—ëŸ¬ê°€ ë°œìƒí–ˆë‹¤ê³  ì‚¬ìš©ìì—ê²Œ ì¸ì§€ì‹œì¼œ ì£¼ì–´ì•¼ í•¨.

ErrorBoundary ì»´í¬ë„ŒíŠ¸ë¡œ LifeCycleSample ì»´í¬ë„ŒíŠ¸ë¥¼ ê°ì‹¸ì£¼ì

```jsx
// ErrorBoundary.js

import { Component } from 'react';

class ErrorBoundary extends Component {
  state = {
    error: false,
  };

  // ì—ëŸ¬ê°€ ë°œìƒí•˜ë©´ ì´ ë©”ì†Œë“œ í˜¸ì¶œ. this.state.error ê°’ì„ trueë¡œ ì—…ë°ì´íŠ¸ í•´ì¤Œ
  componentDidCatch(error, info) {
    this.setState({
      error: true,
    });
    console.log({ error, info });
  }

  render() {
    // this.state.error ê°’ì´ trueë¼ë©´ ì—ëŸ¬ê°€ ë°œìƒí–ˆìŒì„ ì•Œë ¤ì¤Œ
    if (this.state.error) return <div>ì—ëŸ¬ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤!</div>;
    return this.props.children;
  }
}

export default ErrorBoundary;
```

- ì—ëŸ¬ ë°œìƒì‹œ componentDidCatch ë©”ì†Œë“œ í˜¸ì¶œ í›„ this.state.error ê°’ì„ trueë¡œ ì—…ë°ì´íŠ¸
- render í•¨ìˆ˜ì—ì„  this.state.error ê°’ì´ trueë¼ë©´ ì—ëŸ¬ê°€ ë°œìƒí–ˆìŒì„ ì•Œë ¤ì¤Œ

- LifeCycleSampleParent.js
    
    ```jsx
    import { Component } from 'react';
    import LifeCycleSample from './LifeCycleSample';
    import ErrorBoundary from './ErrorBoundary';
    
    // ëœë¤ ìƒ‰ìƒ ìƒì„±
    function getRandomColor() {
      // 000000ë¶€í„° ffffff ê°’ì„ ë°˜í™˜
      return (
        '#' +
        Math.floor(
          Math.random() * 16777215 /*16777215ë¥¼ hexë¡œ í‘œí˜„í•˜ë©´ ffffff*/
        ).toString(16)
      );
    }
    
    class LifeCycleSampleParent extends Component {
      state = {
        color: '#000000',
      };
    
      handleClick = () => {
        // ëœë¤ ìƒ‰ìƒ ë²„íŠ¼ ëˆ„ë¥¼ë•Œë§ˆë‹¤ í˜¸ì¶œë˜ì–´ ëœë¤ìƒ‰ìƒì´ë²¤íŠ¸ ì„¤ì •.
        // ë¶ˆëŸ¬ì˜¨ LifeCycleSample ì»´í¬ë„ŒíŠ¸ì— color ê°’ì„ propsë¡œ ì„¤ì •í•¨.
        this.setState({
          color: getRandomColor(),
        });
      };
    
      render() {
        return (
          <div>
            <div>
              ìœ„ì•„ë˜ ë²„íŠ¼ì„ ë²ˆê°ˆì•„ ëˆ„ë¥´ë©´ì„œ ì–´ë–¤ ë¼ì´í”„ì‚¬ì´í´ ë©”ì†Œë“œë“¤ì„ ì‹¤í–‰í•˜ëŠ”ì§€
              ì²´í¬í•´ë³´ì! (React.strictMode) ì ì‹œ í•´ì œ
            </div>
            <div>ë§ˆì§€ë§‰ ìˆ˜ê°€ 4ì¼ ë•Œ ì—…ë°ì´íŠ¸ ì·¨ì†Œí•˜ëŠ”ì§€ë„ í™•ì¸í•´ë³´ì!</div>
            <button onClick={this.handleClick}> ëœë¤ ìƒ‰ìƒ </button>
            <ErrorBoundary>
              <LifeCycleSample color={this.state.color} />
            </ErrorBoundary>
          </div>
        );
      }
    }
    
    export default LifeCycleSampleParent;
    ```
    

ì´ì œ ë¹ˆ í˜ì´ì§€ë¥¼ ë„ìš°ëŠ”ê²Œ ì•„ë‹ˆë¼, ì—ëŸ¬ê°€ ë°œìƒí–ˆìŒì„ ì•Œë ¤ì£¼ëŠ” ê¸€ì´ ë Œë”ë§ëœë‹¤!

![Untitled](7%203%20%E1%84%85%E1%85%A1%E1%84%8B%E1%85%B5%E1%84%91%E1%85%B3%E1%84%89%E1%85%A1%E1%84%8B%E1%85%B5%E1%84%8F%E1%85%B3%E1%86%AF%20%E1%84%86%E1%85%A6%E1%84%89%E1%85%A5%E1%84%83%E1%85%B3%20%E1%84%89%E1%85%A1%E1%84%8B%E1%85%AD%E1%86%BC%E1%84%92%E1%85%A1%E1%84%80%E1%85%B5%2079d4177bd77c49cea52d959965090819/Untitled.png)